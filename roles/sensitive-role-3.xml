<!--
  ~ Copyright (c) 2012 Evolveum
  ~
  ~ The contents of this file are subject to the terms
  ~ of the Common Development and Distribution License
  ~ (the License). You may not use this file except in
  ~ compliance with the License.
  ~
  ~ You can obtain a copy of the License at
  ~ http://www.opensource.org/licenses/cddl1 or
  ~ CDDLv1.0.txt file in the source code distribution.
  ~ See the License for the specific language governing
  ~ permission and limitations under the License.
  ~
  ~ If applicable, add the following below the CDDL Header,
  ~ with the fields enclosed by brackets [] replaced by
  ~ your own identifying information:
  ~
  ~ Portions Copyrighted 2012 [name of copyright owner]
  -->

<role oid="12345678-d34d-b33f-f00d-000387987988"
      xmlns="http://midpoint.evolveum.com/xml/ns/public/common/common-2a"
      xmlns:c="http://midpoint.evolveum.com/xml/ns/public/common/common-2a">
    <name>Sensitive Role 3</name>
    <description>Security-sensitive role, whose assignment to a user must be approved user's boss or bosses, if there are more of them.</description>
    <approvalSchema>
        <level>
            <name>Approval by the user's managers</name>
            <approverExpression>
                <description>Get user's managers (except the user itself)</description>
                <script>
                    <code>midpoint.getManagersOidsExceptUser(user)</code>
                </script>
            </approverExpression>
            <automaticallyApproved>
                <description>If the user works in F0006 (Scumm Bar), the assignment of this role is automatically approved for him.</description>
                <script>
                    <code>midpoint.isMemberOf(user, midpoint.getOrgByName("F0006").getOid())</code>
                </script>
            </automaticallyApproved>
        </level>
    </approvalSchema>
</role>
